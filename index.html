<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Timestamp Converter</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/luxon@3.4.4/build/global/luxon.min.js"></script>
    <link rel="stylesheet" href="styles.css">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        dark: {
                            bg: '#0a0a0a',
                            card: '#141414',
                            border: '#2a2a2a',
                            hover: '#1f1f1f'
                        }
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-dark-bg text-gray-300 min-h-screen flex flex-col">
    <div class="max-w-4xl mx-auto w-full p-8 flex-1">
        <div class="header-container mb-8">
            <h1 class="text-3xl font-light text-gray-100 mb-4 md:mb-0">Timestamp Converter</h1>
            <div class="controls-container">
                <select 
                    id="localeSelect"
                    class="control-select"
                >
                    <option value="en-US">English (US)</option>
                    <option value="en-GB">English (UK)</option>
                    <option value="de-DE">Deutsch</option>
                    <option value="fr-FR">Français</option>
                    <option value="es-ES">Español</option>
                    <option value="it-IT">Italiano</option>
                    <option value="pt-BR">Português (BR)</option>
                    <option value="ja-JP">日本語</option>
                    <option value="zh-CN">中文 (简体)</option>
                    <option value="ko-KR">한국어</option>
                    <option value="ar-SA">العربية</option>
                    <option value="ru-RU">Русский</option>
                </select>
                <select 
                    id="timezoneSelect"
                    class="control-select"
                >
                    <option value="local">Browser Timezone</option>
                </select>
                <button 
                    id="currentDateBtn"
                    class="control-button"
                >
                    Use current date
                </button>
            </div>
        </div>
        
        <!-- Unix to Date Converter -->
        <div class="bg-dark-card rounded-lg p-6 mb-8 border border-dark-border">
            <h2 class="text-lg font-medium text-gray-200 mb-4">Unix Timestamp → Date</h2>
            <input 
                type="text" 
                id="unixInput" 
                placeholder="Enter Unix timestamp (auto-detects seconds/milliseconds/microseconds)"
                class="w-full px-4 py-3 bg-dark-bg border border-dark-border rounded-lg text-gray-100 placeholder-gray-500 focus:outline-none focus:border-gray-600 transition-colors"
            >
            
            <div id="dateOutputs" class="mt-6 space-y-3 hidden">
                <div class="output-row">
                    <span class="label">ISO 8601 (UTC)</span>
                    <span id="isoUtc" class="value copyable"></span>
                </div>
                <div class="output-row">
                    <span class="label">ISO 8601 (Selected TZ)</span>
                    <span id="isoLocal" class="value copyable"></span>
                </div>
                <div class="output-row">
                    <span class="label">Human Readable</span>
                    <span id="humanReadable" class="value copyable"></span>
                </div>
                <div class="output-row">
                    <span class="label">RFC 822/1123/2822</span>
                    <span id="rfc822" class="value copyable"></span>
                </div>
                <div class="output-row">
                    <span class="label">RFC 2822 (Cookie)</span>
                    <span id="rfc2822Cookie" class="value copyable"></span>
                </div>
                <div class="output-row">
                    <span class="label">RFC 3339</span>
                    <span id="rfc3339" class="value copyable"></span>
                </div>
            </div>
        </div>

        <!-- Date to Unix Converter -->
        <div class="bg-dark-card rounded-lg p-6 border border-dark-border">
            <h2 class="text-lg font-medium text-gray-200 mb-4">Date → Unix Timestamp</h2>
            <input 
                type="text" 
                id="dateInput" 
                placeholder="Enter date in ISO 8601 or various formats"
                class="w-full px-4 py-3 bg-dark-bg border border-dark-border rounded-lg text-gray-100 placeholder-gray-500 focus:outline-none focus:border-gray-600 transition-colors"
            >
            
            <div id="unixOutputs" class="mt-6 space-y-3 hidden">
                <div class="output-row">
                    <span class="label">Unix (seconds)</span>
                    <span id="unixSeconds" class="value copyable"></span>
                </div>
                <div class="output-row">
                    <span class="label">Unix (decimal)</span>
                    <span id="unixDecimal" class="value copyable"></span>
                </div>
                <div class="output-row">
                    <span class="label">Unix (milliseconds)</span>
                    <span id="unixMillis" class="value copyable"></span>
                </div>
                <div class="output-row">
                    <span class="label">Unix (microseconds)</span>
                    <span id="unixMicros" class="value copyable"></span>
                </div>
            </div>
        </div>

        <!-- Tooltip -->
        <div id="tooltip" class="tooltip hidden">Click to copy</div>
        <div id="copiedTooltip" class="tooltip hidden">Copied!</div>
    </div>

    <!-- Footer -->
    <footer class="footer py-4 px-8 border-t border-dark-border">
        <p class="flex items-center justify-center gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><!-- Icon from Material Design Icons by Pictogrammers - https://github.com/Templarian/MaterialDesign/blob/master/LICENSE --><path fill="currentColor" d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg>&nbsp;
            <a
                href="https://github.com/slhck/timestamper"
                target="_blank"
                rel="noopener noreferrer"
                class="text-gray-400 hover:text-gray-200 transition-colors"
            >
                View on GitHub
            </a>
        </p>
    </footer>

    <script>
        const { DateTime } = luxon;

        // Curated list of ~50 most common timezones with proper geographic distribution
        const timezones = [
            // Americas - covering all major time zones
            { value: 'Pacific/Honolulu', label: 'Honolulu', offset: -10 },
            { value: 'America/Anchorage', label: 'Alaska', offset: -9 },
            { value: 'America/Los_Angeles', label: 'Los Angeles (PST)', offset: -8 },
            { value: 'America/Vancouver', label: 'Vancouver', offset: -8 },
            { value: 'America/Phoenix', label: 'Phoenix (Arizona - no DST)', offset: -7 },
            { value: 'America/Denver', label: 'Denver (MST)', offset: -7 },
            { value: 'America/Mexico_City', label: 'Mexico City', offset: -6 },
            { value: 'America/Chicago', label: 'Chicago (CST)', offset: -6 },
            { value: 'America/Regina', label: 'Saskatchewan (no DST)', offset: -6 },
            { value: 'America/New_York', label: 'New York (EST)', offset: -5 },
            { value: 'America/Toronto', label: 'Toronto', offset: -5 },
            { value: 'America/Bogota', label: 'Bogotá', offset: -5 },
            { value: 'America/Caracas', label: 'Caracas', offset: -4 },
            { value: 'America/Halifax', label: 'Halifax (AST)', offset: -4 },
            { value: 'America/Santiago', label: 'Santiago', offset: -3 },
            { value: 'America/Sao_Paulo', label: 'São Paulo', offset: -3 },
            { value: 'America/Buenos_Aires', label: 'Buenos Aires', offset: -3 },
            { value: 'America/St_Johns', label: 'Newfoundland', offset: -3.5 },
            
            // Europe - at least 3-5 major cities
            { value: 'Atlantic/Reykjavik', label: 'Reykjavik', offset: 0 },
            { value: 'Europe/London', label: 'London', offset: 0 },
            { value: 'Europe/Dublin', label: 'Dublin', offset: 0 },
            { value: 'Europe/Lisbon', label: 'Lisbon', offset: 0 },
            { value: 'Europe/Paris', label: 'Paris', offset: 1 },
            { value: 'Europe/Berlin', label: 'Berlin', offset: 1 },
            { value: 'Europe/Amsterdam', label: 'Amsterdam', offset: 1 },
            { value: 'Europe/Rome', label: 'Rome', offset: 1 },
            { value: 'Europe/Madrid', label: 'Madrid', offset: 1 },
            { value: 'Europe/Stockholm', label: 'Stockholm', offset: 1 },
            { value: 'Europe/Warsaw', label: 'Warsaw', offset: 1 },
            { value: 'Europe/Athens', label: 'Athens', offset: 2 },
            { value: 'Europe/Istanbul', label: 'Istanbul', offset: 3 },
            { value: 'Europe/Moscow', label: 'Moscow', offset: 3 },
            
            // Africa - at least 3 major cities
            { value: 'Africa/Casablanca', label: 'Casablanca', offset: 0 },
            { value: 'Africa/Lagos', label: 'Lagos', offset: 1 },
            { value: 'Africa/Cairo', label: 'Cairo', offset: 2 },
            { value: 'Africa/Johannesburg', label: 'Johannesburg', offset: 2 },
            { value: 'Africa/Nairobi', label: 'Nairobi', offset: 3 },
            
            // Middle East & Asia
            { value: 'Asia/Dubai', label: 'Dubai', offset: 4 },
            { value: 'Asia/Tehran', label: 'Tehran', offset: 3.5 },
            { value: 'Asia/Karachi', label: 'Karachi', offset: 5 },
            { value: 'Asia/Kolkata', label: 'New Delhi/Kolkata', offset: 5.5 },
            { value: 'Asia/Dhaka', label: 'Dhaka', offset: 6 },
            { value: 'Asia/Bangkok', label: 'Bangkok', offset: 7 },
            { value: 'Asia/Jakarta', label: 'Jakarta', offset: 7 },
            { value: 'Asia/Singapore', label: 'Singapore', offset: 8 },
            { value: 'Asia/Hong_Kong', label: 'Hong Kong', offset: 8 },
            { value: 'Asia/Shanghai', label: 'Beijing/Shanghai', offset: 8 },
            { value: 'Asia/Tokyo', label: 'Tokyo', offset: 9 },
            { value: 'Asia/Seoul', label: 'Seoul', offset: 9 },
            
            // Oceania
            { value: 'Australia/Perth', label: 'Perth', offset: 8 },
            { value: 'Australia/Adelaide', label: 'Adelaide', offset: 9.5 },
            { value: 'Australia/Brisbane', label: 'Brisbane', offset: 10 },
            { value: 'Australia/Sydney', label: 'Sydney/Melbourne', offset: 10 },
            { value: 'Pacific/Auckland', label: 'Auckland', offset: 12 },
            
            // UTC
            { value: 'UTC', label: 'UTC', offset: 0 }
        ];

        // Populate timezone select with UTC offsets
        function populateTimezones() {
            const select = document.getElementById('timezoneSelect');
            
            // Sort by UTC offset
            timezones.sort((a, b) => a.offset - b.offset);
            
            timezones.forEach(tz => {
                const option = document.createElement('option');
                option.value = tz.value;
                
                // Format offset
                const offsetHours = Math.floor(Math.abs(tz.offset));
                const offsetMinutes = Math.round((Math.abs(tz.offset) % 1) * 60);
                const offsetSign = tz.offset >= 0 ? '+' : '-';
                let offsetStr = `UTC${offsetSign}${offsetHours}`;
                if (offsetMinutes > 0) {
                    offsetStr += `:${offsetMinutes.toString().padStart(2, '0')}`;
                }
                
                option.textContent = `(${offsetStr}) ${tz.label}`;
                select.appendChild(option);
            });
        }

        // Initialize timezones on load
        populateTimezones();

        // Get current locale and timezone settings
        function getSelectedLocale() {
            return document.getElementById('localeSelect').value;
        }

        function getSelectedTimezone() {
            const tz = document.getElementById('timezoneSelect').value;
            return tz === 'local' ? DateTime.local().zoneName : tz;
        }

        // Format date with locale awareness
        function formatWithLocale(dt, format) {
            const locale = getSelectedLocale();
            const timezone = getSelectedTimezone();
            const dtInZone = dt.setZone(timezone);
            
            if (format === 'human') {
                // Locale-specific human readable format
                return dtInZone.setLocale(locale).toLocaleString(DateTime.DATETIME_FULL);
            } else if (format === 'date') {
                return dtInZone.setLocale(locale).toLocaleString(DateTime.DATE_FULL);
            } else if (format === 'time') {
                return dtInZone.setLocale(locale).toLocaleString(DateTime.TIME_WITH_SECONDS);
            }
            return dtInZone.toISO();
        }

        // Update outputs when locale or timezone changes
        function updateAllOutputs() {
            const unixInput = document.getElementById('unixInput');
            const dateInput = document.getElementById('dateInput');
            
            if (unixInput.value) {
                unixInput.dispatchEvent(new Event('input'));
            }
            if (dateInput.value) {
                dateInput.dispatchEvent(new Event('input'));
            }
        }

        document.getElementById('localeSelect').addEventListener('change', updateAllOutputs);
        document.getElementById('timezoneSelect').addEventListener('change', updateAllOutputs);

        // Unix to Date conversion
        document.getElementById('unixInput').addEventListener('input', function(e) {
            const input = e.target.value.trim();
            if (!input) {
                document.getElementById('dateOutputs').classList.add('hidden');
                return;
            }

            let dt;
            
            // Check if input contains a decimal point (seconds.milliseconds format)
            if (input.includes('.')) {
                const timestamp = parseFloat(input);
                if (isNaN(timestamp)) {
                    document.getElementById('dateOutputs').classList.add('hidden');
                    return;
                }
                // Convert seconds.milliseconds to DateTime
                dt = DateTime.fromSeconds(timestamp);
            } else {
                // Integer timestamp
                const timestamp = parseInt(input);
                if (isNaN(timestamp)) {
                    document.getElementById('dateOutputs').classList.add('hidden');
                    return;
                }
                
                // Auto-detect timestamp precision
                if (timestamp.toString().length <= 10) {
                    // Seconds
                    dt = DateTime.fromSeconds(timestamp);
                } else if (timestamp.toString().length <= 13) {
                    // Milliseconds
                    dt = DateTime.fromMillis(timestamp);
                } else {
                    // Microseconds
                    dt = DateTime.fromMillis(Math.floor(timestamp / 1000));
                }
            }

            if (!dt.isValid) {
                document.getElementById('dateOutputs').classList.add('hidden');
                return;
            }

            // Set all the different formats
            const timezone = getSelectedTimezone();
            const locale = getSelectedLocale();
            
            document.getElementById('isoUtc').textContent = dt.toUTC().toISO();
            document.getElementById('isoLocal').textContent = dt.setZone(timezone).toISO();
            document.getElementById('humanReadable').textContent = formatWithLocale(dt, 'human');
            document.getElementById('rfc822').textContent = dt.setZone(timezone).toRFC2822();
            document.getElementById('rfc2822Cookie').textContent = dt.setZone(timezone).toFormat('EEEE, dd-MMM-yy HH:mm:ss ZZZ');
            document.getElementById('rfc3339').textContent = dt.setZone(timezone).toISO();

            document.getElementById('dateOutputs').classList.remove('hidden');
        });

        // Date to Unix conversion
        document.getElementById('dateInput').addEventListener('input', function(e) {
            const input = e.target.value.trim();
            if (!input) {
                document.getElementById('unixOutputs').classList.add('hidden');
                return;
            }

            let dt = null;

            // Try various parsing strategies
            const parseStrategies = [
                // ISO 8601
                () => DateTime.fromISO(input),
                // RFC 2822
                () => DateTime.fromRFC2822(input),
                // SQL
                () => DateTime.fromSQL(input),
                // HTTP (RFC 1123)
                () => DateTime.fromHTTP(input),
                // Common US format
                () => DateTime.fromFormat(input, 'MM/dd/yyyy'),
                () => DateTime.fromFormat(input, 'MM/dd/yyyy HH:mm:ss'),
                () => DateTime.fromFormat(input, 'MM/dd/yyyy h:mm:ss a'),
                // European format
                () => DateTime.fromFormat(input, 'dd/MM/yyyy'),
                () => DateTime.fromFormat(input, 'dd/MM/yyyy HH:mm:ss'),
                // Other common formats
                () => DateTime.fromFormat(input, 'yyyy-MM-dd'),
                () => DateTime.fromFormat(input, 'yyyy-MM-dd HH:mm:ss'),
                () => DateTime.fromFormat(input, 'dd-MM-yyyy'),
                () => DateTime.fromFormat(input, 'dd-MM-yyyy HH:mm:ss'),
                // JS Date string
                () => DateTime.fromJSDate(new Date(input)),
            ];

            for (const strategy of parseStrategies) {
                try {
                    const parsed = strategy();
                    if (parsed && parsed.isValid) {
                        dt = parsed;
                        break;
                    }
                } catch (e) {
                    // Continue to next strategy
                }
            }

            if (!dt || !dt.isValid) {
                document.getElementById('unixOutputs').classList.add('hidden');
                return;
            }

            const seconds = Math.floor(dt.toSeconds());
            const millis = dt.toMillis();
            const micros = millis * 1000;
            const decimalFormat = dt.toSeconds().toFixed(3);

            document.getElementById('unixSeconds').textContent = seconds.toString();
            document.getElementById('unixDecimal').textContent = decimalFormat;
            document.getElementById('unixMillis').textContent = millis.toString();
            document.getElementById('unixMicros').textContent = micros.toString();

            document.getElementById('unixOutputs').classList.remove('hidden');
        });

        // Copy functionality
        const tooltip = document.getElementById('tooltip');
        const copiedTooltip = document.getElementById('copiedTooltip');

        document.addEventListener('click', async function(e) {
            if (e.target.classList.contains('copyable')) {
                const text = e.target.textContent;
                try {
                    await navigator.clipboard.writeText(text);
                    
                    // Remove text selection
                    window.getSelection().removeAllRanges();
                    
                    // Show copied tooltip
                    copiedTooltip.style.left = e.pageX + 'px';
                    copiedTooltip.style.top = (e.pageY - 30) + 'px';
                    copiedTooltip.classList.remove('hidden');
                    
                    setTimeout(() => {
                        copiedTooltip.classList.add('hidden');
                    }, 1500);
                } catch (err) {
                    console.error('Failed to copy:', err);
                }
            }
        });

        document.addEventListener('mouseover', function(e) {
            if (e.target.classList.contains('copyable')) {
                tooltip.style.left = e.pageX + 'px';
                tooltip.style.top = (e.pageY - 30) + 'px';
                tooltip.classList.remove('hidden');
            }
        });

        document.addEventListener('mouseout', function(e) {
            if (e.target.classList.contains('copyable')) {
                tooltip.classList.add('hidden');
            }
        });

        // "Use current date" button functionality
        document.getElementById('currentDateBtn').addEventListener('click', function() {
            const now = DateTime.now();
            
            // Fill Unix timestamp input (in milliseconds)
            const unixInput = document.getElementById('unixInput');
            unixInput.value = now.toMillis().toString();
            unixInput.dispatchEvent(new Event('input'));
            
            // Fill date input with ISO format
            const dateInput = document.getElementById('dateInput');
            dateInput.value = now.toISO();
            dateInput.dispatchEvent(new Event('input'));
        });
    </script>
</body>
</html>